# go-depcheck 設定ファイル
# クリーンアーキテクチャの依存関係ルールを定義する
# 参照: https://github.com/v-standard/go-depcheck

# グローバルで無視するファイルパターン
ignorePatterns:
  - 'mock_.*\.go$'
  - '.*_mock\.go$'
  - '_test\.go$'

# 依存関係ルール
rules:
  # domain層 → infra層 への依存禁止
  - from: '^github\.com/canpok1/ai-feed/internal/domain.*$'
    to:
      - '^github\.com/canpok1/ai-feed/internal/infra.*$'

  # domain層 → cmd層 への依存禁止
  - from: '^github\.com/canpok1/ai-feed/internal/domain.*$'
    to:
      - '^github\.com/canpok1/ai-feed/cmd.*$'

  # infra層 → cmd層 への依存禁止
  - from: '^github\.com/canpok1/ai-feed/internal/infra.*$'
    to:
      - '^github\.com/canpok1/ai-feed/cmd.*$'

  # cmd/runner層 → cmd層 への依存禁止（cmd/runner自身は除く）
  # cmd はプレゼンテーション層、cmd/runner はビジネスロジック層
  - from: '^github\.com/canpok1/ai-feed/cmd/runner.*$'
    to:
      - '^github\.com/canpok1/ai-feed/cmd$'
      - '^github\.com/canpok1/ai-feed/cmd/[^r].*$'
