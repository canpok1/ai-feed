---
name: plan-pr
description: プルリクエストのレビューコメントを確認し、対応用のタスクファイル作成をサポートします。既存スキルを使用してレビューコメントを取得し、Claude Codeがその情報を元にtmp/todoフォルダにタスクファイルを作成します。
---

## 使用方法

### 手順

1. **レビューコメントを確認する**
   - get-pr-review-commentsスキルを使用してPRのレビューコメントを取得
   ```bash
   ./.claude/skills/get-pr-review-comments/get-pr-review-comments.sh "#123"
   ```

2. **必要に応じてスレッドの詳細を確認する**（コンテキストが必要な場合）
   - get-pr-review-thread-detailsスキルを使用
   ```bash
   ./.claude/skills/get-pr-review-thread-details/get-pr-review-thread-details.sh "<スレッドID>"
   ```

3. **コメント1件ごとに、内容を確認してタスクファイルを作成**
   - レビュワーからの意見を表すもの、かつ対応が必要だと判断した場合
     - 「レビューコメントを元に対応する」という内容のタスクファイルをtmp/todoフォルダに作成
   - レビュワーからの意見を表すもの、かつ対応が不要だと判断した場合
     - 「レビューコメントに対応不要である旨の意見を返信する」という内容のタスクファイルをtmp/todoフォルダに作成
   - レビュワーからの承認を表すものである場合
     - 「レビューコメントをresolveする」という内容のタスクファイルをtmp/todoフォルダに作成

## タスクファイル作成ガイド

### ファイル名フォーマット

```
pr_{PRの番号}_task_{2桁0埋めの1からの連番}_{タスク概要(英語)}.md
```

**例**: PR #1に対するタスクの場合

```
pr_1_task_01_fix_typo.md
pr_1_task_02_respond_to_comment.md
pr_1_task_03_resolve_approved_thread.md
```

### ファイル内容のテンプレート

```markdown
## 対応内容の概要

## 対応内容の詳細

### レビューコメント情報

- PR番号: {PRの番号を記載する}
- レビュースレッドID: {レビュースレッドIDを記載する}
- 投稿者: {レビュースレッドの議論の参加者名を記載する（複数人いる場合はスペース区切り）}

### 編集対象ファイル

### 完了条件

- コメントが対応の必要性を表すもの、かつ対応が必要だと判断した場合
    - [ ] 対応を行いコミット・プッシュすること
    - [ ] コメントに対して議論の参加者全員宛に返信すること
    - [ ] レビュースレッドをresolveしていないこと
- コメントが対応の必要性を表すものである場合
    - [ ] コメントに対して議論の参加者全員宛に返信すること
    - [ ] レビュースレッドをresolveしていないこと
- コメントがレビュワーの承認を表すものである場合
    - [ ] レビュースレッドをresolveしていること

### 備考
- コメントの返信やresolveは以下のスキルを使用する
    - スレッドの詳細を確認: get-pr-review-thread-detailsスキル
    - 返信を投稿: reply-to-review-threadスキル
    - resolveする: resolve-pr-threadスキル
```

## 典型的なワークフロー

1. **レビューコメント取得**
   ```bash
   ./.claude/skills/get-pr-review-comments/get-pr-review-comments.sh "#123"
   ```

2. **レビューコメントの分類**
   - Claude Codeが各コメントを分析
   - 対応が必要か、返信のみか、承認かを判断

3. **タスクファイル作成**
   - tmp/todoフォルダに適切な数のタスクファイルを作成
   - 各タスクファイルに具体的な対応内容を記載

4. **タスクの実行**
   - 作成されたタスクファイルに従って対応を進める
   - 適切なスキルを使用して返信・resolve

## 注意事項

- tmp/todoフォルダが存在しない場合は自動的に作成されます
- レビューコメントの取得には GitHub CLI (`gh`) が必要です
- 未解決のコメントのみが対象となります
- コメントの対応状況に応じて、適切なスキルを使い分けてください

## 関連スキル

- **get-pr-review-comments**: PRの未解決レビューコメントを取得
- **get-pr-review-thread-details**: レビュースレッドの詳細情報を取得
- **reply-to-review-thread**: レビュースレッドに返信を投稿
- **resolve-pr-thread**: レビュースレッドを解決済みに変更

## 関連ドキュメント

- [コントリビューションガイド](../../../docs/04_contributing.md) - プルリクエストの作成方法
